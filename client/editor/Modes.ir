::
  default_mode\s\$
  @editors\O.<s, editor.Editor>\$
  @modes\A.<s>\ [default_mode]

Current mode.
:mode+\s\
  assert(@modes.length > 0)
  => @modes[@modes.length - 1]

Currently selected editor.
:editor+\editor.Editor\
  => @editors[@.mode]
  
:changeModeTo
  next_mode\s\$
  assert(next_mode != @.mode)
  @modes.push(next_mode)
  @.editor.activate()

:popMode
  next_mode\s\?
  @.editor.deactivate()
  @modes.pop()
  assert(@modes.length > 0)
  if next_mode
    @.changeModeTo(next_mode)
